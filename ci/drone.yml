---
kind: pipeline
type: exec
name: windows

platform:
  os: windows
  arch: amd64

steps:
- name: submodules
  commands:
  - git submodule update --init --recursive
- name: build
  commands:
  - ./ci/build-windows.bat
  - Exit $LastExitCode # Required to return correct code
---
kind: pipeline
type: docker
name: ubuntu

steps:
- name: submodules
  image: alpine/git
  commands:
  - git submodule update --init --recursive
- name: build
  image: svendcsvendsen/judoassistant-ubuntu
  commands:
  - meson --buildtype=release build-release
  - ninja -j2 -C build-release
---
kind: pipeline
type: docker
name: ubuntu-web

steps:
- name: build
  image: svendcsvendsen/judoassistant-ubuntu
  commands:
  - meson --buildtype=release -Dui=false -Dweb=true build-release
  - ninja -j2 -C build-release
